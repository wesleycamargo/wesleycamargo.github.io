<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Creating Azure Databricks with Bicep and Azure DevOps YAML Pipelines</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Creating Azure Databricks with Bicep and Azure DevOps YAML Pipelines</h1>
</header>
<section data-field="subtitle" class="p-summary">
Continuing the DataOps Automation series, in this post I will demonstrate how to create your Databricks workspace using Infrastructure as…
</section>
<section data-field="body" class="e-content">
<section name="b4c4" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="41eb" id="41eb" class="graf graf--h3 graf--leading graf--title">Creating Azure Databricks with Bicep and Azure DevOps YAML Pipelines</h3><h4 name="40d3" id="40d3" class="graf graf--h4 graf-after--h3 graf--subtitle">Continuing the DataOps Automation series, in this post I will demonstrate how to create your Databricks workspace using Infrastructure as Code with Bicep and Azure DevOps YAML Pipelines to deploy it in Azure. Let’s check it out!</h4><figure name="d329" id="d329" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*q45YY42etgKPognuoFZJmA.jpeg" data-width="3778" data-height="5667" src="https://cdn-images-1.medium.com/max/800/1*q45YY42etgKPognuoFZJmA.jpeg"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@benjopen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/@benjopen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Benjamin Jopen</a> on <a href="https://unsplash.com/s/photos/brick-construction?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/s/photos/brick-construction?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Unsplash</a></figcaption></figure><p name="abe4" id="abe4" class="graf graf--p graf-after--figure">In the previous articles, you can check how to<a href="https://towardsdatascience.com/dataops-automation-creating-azure-data-factory-with-git-integration-using-bicep-376fd3b5bc81" data-href="https://towardsdatascience.com/dataops-automation-creating-azure-data-factory-with-git-integration-using-bicep-376fd3b5bc81" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"> create an Azure Data Factory with git integration using Bicep</a> and also the <a href="https://towardsdatascience.com/azure-data-factory-ci-cd-made-simple-building-and-deploying-your-arm-templates-with-azure-devops-30c30595afa5" data-href="https://towardsdatascience.com/azure-data-factory-ci-cd-made-simple-building-and-deploying-your-arm-templates-with-azure-devops-30c30595afa5" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">easiest way to create a CI/CD pipeline for Azure Data Factory</a></p><p name="17a5" id="17a5" class="graf graf--p graf-after--p">At the end of the post, you can check a complete YAML pipeline read to be used!</p><h3 name="89db" id="89db" class="graf graf--h3 graf-after--p">What is a Bicep template?</h3><p name="fafc" id="fafc" class="graf graf--p graf-after--h3">If you are not familiar with Bicep, this is a DSL for the ARM Templates, that has a cleaner syntax, better support to modules, and other great features. It also has a nice <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/quickstart-create-bicep-use-visual-studio-code?tabs=CLI&amp;WT.mc_id=devops-34401-jagord" data-href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/quickstart-create-bicep-use-visual-studio-code?tabs=CLI&amp;WT.mc_id=devops-34401-jagord" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Visual Studio Code extension </a>that helps a lot in building templates from scratch.</p><figure name="5164" id="5164" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*FsceF8fsND7cZ2BM.png" data-width="652" data-height="165" src="https://cdn-images-1.medium.com/max/800/0*FsceF8fsND7cZ2BM.png"><figcaption class="imageCaption">Nice extension for Visual Studio Code! — Image from <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/install#development-environment" data-href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/install#development-environment" class="markup--anchor markup--figure-anchor" rel="noopener" target="_blank">Microsoft Docs</a></figcaption></figure><p name="8f4d" id="8f4d" class="graf graf--p graf-after--figure">When you run a deployment using a bicep template, it transpile the file and generates a native ARM Template, similar to what happens between Typescript and Javascript.</p><p name="41be" id="41be" class="graf graf--p graf-after--p">If you want to learn more about it, check the official documentation <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/overview" data-href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/bicep/overview" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><h3 name="0931" id="0931" class="graf graf--h3 graf-after--p">Creating the Infrastructure as Code for Azure Databricks</h3><h4 name="c69d" id="c69d" class="graf graf--h4 graf-after--h3">Creating a Resource Group with Azure CLI</h4><p name="0551" id="0551" class="graf graf--p graf-after--h4">To deploy our Databricks workspace we need to have a Resource Group created in your Azure Subscription. The easiest way to do that is through Azure CLI. To do that you need to log in with the command <code class="markup--code markup--p-code">az login</code> and then run the following command:</p><pre name="1078" id="1078" class="graf graf--pre graf-after--p">az group create -name RG-Databricks -location northeurope</pre><p name="e4d0" id="e4d0" class="graf graf--p graf-after--pre">Replace the parameters name and location for those that best suit your needs.</p><h4 name="7825" id="7825" class="graf graf--h4 graf-after--p">Creating Bicep templates for Azure Databricks</h4><p name="1a44" id="1a44" class="graf graf--p graf-after--h4">The Bicep template for Azure Databricks it’s quite simple and has 4 main sections:</p><p name="848e" id="848e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Parameters:</strong></p><ul class="postList"><li name="beb1" id="beb1" class="graf graf--li graf-after--p">Workspace Name: If you do not provide a value, it uses a <code class="markup--code markup--li-code">uniqueString</code> function, which ensures that it will always be the same, as this is based on the resource group id.</li><li name="f21e" id="f21e" class="graf graf--li graf-after--li">Location: By default, this is using the resource group location</li><li name="d277" id="d277" class="graf graf--li graf-after--li">SKU: The default value is trial, so be sure to replace it in your real-life scenario ;).</li></ul><figure name="a820" id="a820" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/wesleycamargo/141accbfe022118811f6b9519306d67f?file=databricks.bicep.js"></script></figure><p name="d297" id="d297" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Variables: </strong>The template also has the variable <code class="markup--code markup--p-code">managedResourceGroupName</code> . This resource group will be managed by Azure Databricks to create your clusters later on.</p><p name="7160" id="7160" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Resources: </strong>Here we have only one resource that is the Databrics Workspace. This is consuming the API version <code class="markup--code markup--p-code">2018–04–01</code> .</p><p name="c0f2" id="c0f2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Output: </strong>This section contains the variables that you need to expose. It means that they can be accessed by other processes later on in your deployment process.</p><h3 name="6ae4" id="6ae4" class="graf graf--h3 graf-after--p">Deploying Bicep with Azure DevOps YAML Pipelines</h3><h4 name="b242" id="b242" class="graf graf--h4 graf-after--h3">Building Bicep Template</h4><p name="f594" id="f594" class="graf graf--p graf-after--h4">As I said before, it is possible to “build” the Bicep template transpiling it into an ARM Template. So to ensure that our template is valid, let’s do it!</p><p name="bfb9" id="bfb9" class="graf graf--p graf-after--p">To build it, you will also use the Azure CLI. The command is also quite simple:</p><pre name="546f" id="546f" class="graf graf--pre graf-after--p">az bicep build --file &lt;your file&gt; --outdir &lt;your directory&gt;</pre><p name="7ea3" id="7ea3" class="graf graf--p graf-after--pre">To create an Azure DevOps YAML Pipeline, we will run the command above in an AzureCLI task:</p><figure name="d311" id="d311" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/wesleycamargo/141accbfe022118811f6b9519306d67f?file=azure-pipelines-build.yml.js"></script></figure><p name="0fbe" id="0fbe" class="graf graf--p graf-after--figure">After transpile the Bicep into ARM Template, it will deploy as a Deployment Artefact read to be consumed:</p><figure name="ed4b" id="ed4b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*GhTEFX4p8uW0MOolGJJRsQ.png" data-width="1205" data-height="637" src="https://cdn-images-1.medium.com/max/800/1*GhTEFX4p8uW0MOolGJJRsQ.png"><figcaption class="imageCaption">Image prepared by author</figcaption></figure><figure name="04d9" id="04d9" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*GsfTVy6oBm0Deal_YVFUcw.png" data-width="397" data-height="370" src="https://cdn-images-1.medium.com/max/800/1*GsfTVy6oBm0Deal_YVFUcw.png"><figcaption class="imageCaption">Image prepared by author</figcaption></figure><p name="9da9" id="9da9" class="graf graf--p graf-after--figure">Build your Bicep is a good practice, as you can validate that there is no error in it and gather all necessary files to be deployed.</p><h4 name="99ba" id="99ba" class="graf graf--h4 graf-after--p">Deploying Bicep with YAML Pipelines</h4><p name="c504" id="c504" class="graf graf--p graf-after--h4">With the artifacts generated in the build step, now we are ready to deploy them in our environment. For that it is necessary to add one more stage into the build YAML, with the instruction to run the ARM Template:</p><figure name="d36a" id="d36a" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/wesleycamargo/141accbfe022118811f6b9519306d67f?file=azure-pipelines-deploy.yml.js"></script></figure><p name="8a82" id="8a82" class="graf graf--p graf-after--figure">It consumes the task <code class="markup--code markup--p-code">AzureResourceManagerTemplateDeployment@3</code> that is responsible to run the ARM Template into Azure Subscription. You can have more information about this task <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-resource-group-deployment?view=azure-devops" data-href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-resource-group-deployment?view=azure-devops" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><p name="b05e" id="b05e" class="graf graf--p graf-after--p">This stage represents the development stage. To deploy it in other environments, you just need to copy it and replace the values according to your environments :)</p><h3 name="4034" id="4034" class="graf graf--h3 graf-after--p">Real life example</h3><p name="d57e" id="d57e" class="graf graf--p graf-after--h3">To check these examples in more realistic situations, I have been working in a GitHub repository with examples of pipelines configured and working. You can check that in the DevOps Nights GitHub here: <a href="https://github.com/devopsnights/azuredevops-yaml-quickstart-templates" data-href="https://github.com/devopsnights/azuredevops-yaml-quickstart-templates" class="markup--anchor markup--p-anchor" rel="noopener nofollow noopener" target="_blank">devopsnights/azuredevops-yaml-quickstart-templates (github.com)</a></p><h3 name="a2f1" id="a2f1" class="graf graf--h3 graf-after--p">Databricks YAML Pipeline</h3><p name="0e9a" id="0e9a" class="graf graf--p graf-after--h3">As promised below you can check a full Azure DevOps YAML Pipeline configured and working:</p><figure name="85bd" id="85bd" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/wesleycamargo/141accbfe022118811f6b9519306d67f?file=azure-pipelines.yml.js"></script></figure><h3 name="6f86" id="6f86" class="graf graf--h3 graf-after--figure">Conclusion</h3><p name="573f" id="573f" class="graf graf--p graf-after--h3">Bicep has become a very relevant tool for Azure and has a good potential to be the default tool for Infrastructure as Code in Azure. So start to be familiar with it now, will be very relevant in the future :)</p><p name="a877" id="a877" class="graf graf--p graf-after--p graf--trailing">I hope this post could help you, and see you in the next post!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@camargo-wes" class="p-author h-card">Wesley Camargo</a> on <a href="https://medium.com/p/4bf85be30cc7"><time class="dt-published" datetime="2021-08-20T17:45:12.653Z">August 20, 2021</time></a>.</p><p><a href="https://medium.com/@camargo-wes/creating-azure-databricks-with-bicep-and-azure-devops-yaml-pipelines-4bf85be30cc7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on July 5, 2025.</p></footer></article></body></html>